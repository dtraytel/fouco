<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Theory Stream_Op_Input3 (Isabelle2014: August 2014)</title>
<link media="all" rel="stylesheet" type="text/css" href="isabelle.css"/>
</head>

<body>
<div class="head"><h1>Theory Stream_Op_Input3</h1>

<span class="command">theory</span> <span class="name">Stream_Op_Input3</span><br/>
<span class="keyword">imports</span> <a href="Stream_FreeAlg3.html"><span class="name">Stream_FreeAlg3</span></a><br/>

</div>
<div class="source">
<pre><span class="command">theory</span> Stream_Op_Input3
<span class="keyword2">imports</span> Stream_FreeAlg3
<span class="keyword2">begin</span>

<span class="command">abbreviation</span> <span class="string">&quot;PLS3 &equiv; \&lt;oo&gt;\&lt;pp&gt;3 o Abs_&Sigma;3 o Inl o Abs_&Sigma;2 o Inl o Abs_&Sigma;1 o Inr :: &#39;a &Sigma;&Sigma;3 K1 =&gt; &#39;a &Sigma;&Sigma;3&quot;</span>
<span class="command">abbreviation</span> <span class="string">&quot;PRD3 &equiv; \&lt;oo&gt;\&lt;pp&gt;3 o Abs_&Sigma;3 o Inl o Abs_&Sigma;2 o Inr :: &#39;a &Sigma;&Sigma;3 K2 =&gt; &#39;a &Sigma;&Sigma;3&quot;</span>
<span class="command">abbreviation</span> <span class="string">&quot;EXP3 &equiv; \&lt;oo&gt;\&lt;pp&gt;3 o Abs_&Sigma;3 o Inr :: &#39;a &Sigma;&Sigma;3 K3 =&gt; &#39;a &Sigma;&Sigma;3&quot;</span>

<span class="command">lemma</span> PLS3_transfer<span class="delimiter">[</span>transfer_rule<span class="delimiter">]</span><span class="delimiter">:</span>
  <span class="string">&quot;(K1_rel (&Sigma;&Sigma;3_rel R) ===&gt; &Sigma;&Sigma;3_rel R) PLS3 PLS3&quot;</span>
  <span class="command">by</span> transfer_prover

<span class="command">lemma</span> PRD3_transfer<span class="delimiter">[</span>transfer_rule<span class="delimiter">]</span><span class="delimiter">:</span>
  <span class="string">&quot;(K2_rel (&Sigma;&Sigma;3_rel R) ===&gt; &Sigma;&Sigma;3_rel R) PRD3 PRD3&quot;</span>
  <span class="command">by</span> transfer_prover

<span class="command">lemma</span> EXP3_transfer<span class="delimiter">[</span>transfer_rule<span class="delimiter">]</span><span class="delimiter">:</span>
  <span class="string">&quot;(K3_rel (&Sigma;&Sigma;3_rel R) ===&gt; &Sigma;&Sigma;3_rel R) EXP3 EXP3&quot;</span>
  <span class="command">by</span> transfer_prover

<span class="command">definition</span> exp <span class="delimiter">::</span> <span class="string">&quot;nat =&gt; nat&quot;</span> <span class="keyword2">where</span> <span class="string">&quot;exp n = 2 ^ n&quot;</span>

<span class="command">primrec</span> &rho;3 <span class="delimiter">::</span> <span class="string">&quot;(&#39;a &times; &#39;a F) K3 =&gt; &#39;a &Sigma;&Sigma;3 F&quot;</span> <span class="keyword2">where</span>
  <span class="string">&quot;&rho;3 (I a_m_a&#39;) =
    (let a = I (fst a_m_a&#39;) ; m = fst (snd a_m_a&#39;) ; a&#39; = snd (snd a_m_a&#39;)
    in (exp m, PRD3 (leaf3 a&#39;, K3_as_&Sigma;&Sigma;3 a)))&quot;</span>

<span class="command">lemma</span> I_transfer<span class="delimiter">[</span>transfer_rule<span class="delimiter">]</span><span class="delimiter">:</span>
  <span class="string">&quot;(R ===&gt; K3_rel R) I I&quot;</span>
  <span class="command">by</span> auto

<span class="command">lemma</span> rec_K3_transfer<span class="delimiter">[</span>transfer_rule<span class="delimiter">]</span><span class="delimiter">:</span> <span class="string">&quot;((R ===&gt; S) ===&gt; K3_rel R ===&gt; S) rec_K3 rec_K3&quot;</span>
  <span class="command">apply</span> <span class="delimiter">(</span>rule rel_funI<span class="delimiter">)</span><span class="delimiter">+</span>
  <span class="command">apply</span> <span class="delimiter">(</span>rename_tac x y<span class="delimiter">)</span>
  <span class="command">apply</span> <span class="delimiter">(</span>case_tac x<span class="delimiter">)</span>
  <span class="command">apply</span> <span class="delimiter">(</span>case_tac y<span class="delimiter">)</span>
  <span class="command">apply</span> <span class="delimiter">(</span>auto elim<span class="delimiter">:</span> rel_funE<span class="delimiter">)</span>
  <span class="command">done</span>

<span class="command">lemma</span> &rho;3_transfer<span class="delimiter">[</span>transfer_rule<span class="delimiter">]</span><span class="delimiter">:</span>
  <span class="string">&quot;(K3_rel (rel_prod R (F_rel R)) ===&gt; F_rel (&Sigma;&Sigma;3_rel R)) &rho;3 &rho;3&quot;</span>
  <span class="command">unfolding</span> rel_pre_J_def id_apply vimage2p_def BNF_Comp.id_bnf_comp_def &rho;3_def<span class="delimiter">[</span>abs_def<span class="delimiter">]</span> Let_def
  <span class="command">by</span> transfer_prover



<span class="command">end</span></pre>

</div>
</body>
</html>
