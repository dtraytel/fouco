<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Theory Stream_Op_Input7 (Isabelle2014: August 2014)</title>
<link media="all" rel="stylesheet" type="text/css" href="isabelle.css"/>
</head>

<body>
<div class="head"><h1>Theory Stream_Op_Input7</h1>

<span class="command">theory</span> <span class="name">Stream_Op_Input7</span><br/>
<span class="keyword">imports</span> <a href="Stream_FreeAlg7.html"><span class="name">Stream_FreeAlg7</span></a><br/>

</div>
<div class="source">
<pre><span class="command">theory</span> Stream_Op_Input7
<span class="keyword2">imports</span> Stream_FreeAlg7
<span class="keyword2">begin</span>

<span class="command">abbreviation</span> <span class="string">&quot;INTERLEAVE7 &equiv; \&lt;oo&gt;\&lt;pp&gt;7 o Abs_&Sigma;7 o Inl o Abs_&Sigma;6 o Inr :: &#39;a &Sigma;&Sigma;7 K6 =&gt; &#39;a &Sigma;&Sigma;7&quot;</span>
<span class="command">abbreviation</span> <span class="string">&quot;INV7 &equiv; \&lt;oo&gt;\&lt;pp&gt;7 o Abs_&Sigma;7 o Inr :: &#39;a &Sigma;&Sigma;7 K7 =&gt; &#39;a &Sigma;&Sigma;7&quot;</span>

<span class="command">lemma</span> INTERLEAVE7_transfer<span class="delimiter">[</span>transfer_rule<span class="delimiter">]</span><span class="delimiter">:</span>
  <span class="string">&quot;(K6_rel (&Sigma;&Sigma;7_rel R) ===&gt; &Sigma;&Sigma;7_rel R) INTERLEAVE7 INTERLEAVE7&quot;</span>
  <span class="command">by</span> transfer_prover

<span class="command">lemma</span> EXP7_transfer<span class="delimiter">[</span>transfer_rule<span class="delimiter">]</span><span class="delimiter">:</span>
  <span class="string">&quot;(K7_rel (&Sigma;&Sigma;7_rel R) ===&gt; &Sigma;&Sigma;7_rel R) INV7 INV7&quot;</span>
  <span class="command">by</span> transfer_prover

<span class="command">primrec</span> &rho;7 <span class="delimiter">::</span> <span class="string">&quot;(&#39;a &times; &#39;a F) K7 =&gt; &#39;a &Sigma;&Sigma;7 F&quot;</span> <span class="keyword2">where</span>
  <span class="string">&quot;&rho;7 (I a_m_a&#39;) =
    (let a = I (fst a_m_a&#39;) ; m = fst (snd a_m_a&#39;) ; a&#39; = (snd (snd a_m_a&#39;))
    in (1 - m, INV7 (I (leaf7 a&#39;))))&quot;</span>

<span class="command">lemma</span> I_transfer<span class="delimiter">[</span>transfer_rule<span class="delimiter">]</span><span class="delimiter">:</span>
  <span class="string">&quot;(R ===&gt; K7_rel R) I I&quot;</span>
  <span class="command">by</span> auto

<span class="command">lemma</span> rec_K7_transfer<span class="delimiter">[</span>transfer_rule<span class="delimiter">]</span><span class="delimiter">:</span> <span class="string">&quot;((R ===&gt; S) ===&gt; K7_rel R ===&gt; S) rec_K7 rec_K7&quot;</span>
  <span class="command">apply</span> <span class="delimiter">(</span>rule rel_funI<span class="delimiter">)</span><span class="delimiter">+</span>
  <span class="command">apply</span> <span class="delimiter">(</span>rename_tac x y<span class="delimiter">)</span>
  <span class="command">apply</span> <span class="delimiter">(</span>case_tac x<span class="delimiter">)</span>
  <span class="command">apply</span> <span class="delimiter">(</span>case_tac y<span class="delimiter">)</span>
  <span class="command">apply</span> <span class="delimiter">(</span>auto elim<span class="delimiter">:</span> rel_funE<span class="delimiter">)</span>
  <span class="command">done</span>

<span class="command">lemma</span> &rho;7_transfer<span class="delimiter">[</span>transfer_rule<span class="delimiter">]</span><span class="delimiter">:</span>
  <span class="string">&quot;(K7_rel (rel_prod R (F_rel R)) ===&gt; F_rel (&Sigma;&Sigma;7_rel R)) &rho;7 &rho;7&quot;</span>
  <span class="command">unfolding</span> rel_pre_J_def id_apply vimage2p_def BNF_Comp.id_bnf_comp_def &rho;7_def<span class="delimiter">[</span>abs_def<span class="delimiter">]</span> Let_def
  <span class="command">by</span> transfer_prover



<span class="command">end</span></pre>

</div>
</body>
</html>
